# LLMPoker - Multi-Agent LLM 德州扑克模拟器 - 项目总结

## 🎯 项目概述

本项目成功构建并迭代了一个基于LLM（大语言模型）的多智能体德州扑克模拟器。通过一系列的调试和功能增强，我们实现了一个拥有更高智能、更强健壮性和更佳可解释性的模拟环境。

## ✅ 已完成的核心功能

-   **🧠 智能LLM决策与分析**:
    -   LLM被设计为先输出详细的**思考过程**，再通过`<action>`标签给出最终决策。
    -   这种模式极大地增强了模型行为的**可解释性**，便于分析其策略优劣。
    -   解析器已适配该模式，能稳定提取决策指令。

-   **🎯 精确且丰富的状态提示**:
    -   重构了向LLM提供的游戏状态提示，包含了**每手牌开始时的筹码**、带**轮次分隔符**的完整下注历史。
    -   为当前决策玩家提供了清晰、定制化的回合信息，有效避免了因信息不足导致的决策错误。

-   **🔧 健壮的游戏引擎与Bug修复**:
    -   成功修复了多个关键Bug，包括：
        -   因`openai`库版本升级导致的`AttributeError`。
        -   牌力评估函数中的`AttributeError: 'list' object has no attribute 'get'`。
        -   日志记录中因缺少`eligible_players`导致的`KeyError`。
        -   Preflop轮次中，大盲玩家在无人加注时缺少行动选项的**核心逻辑漏洞**。
    -   通过上述修复，游戏流程的稳定性和规则的正确性得到了保障。

-   **🤖 灵活的多LLM支持**:
    -   通过`config.py`可以轻松配置和切换不同的LLM模型作为玩家。
    -   实现了玩家LLM模型的轮换分配。

-   **📝 详细的日志系统与查看工具**:
    -   完整记录每手牌的进程，包括所有玩家的行动、公共牌、底池变化。
    -   特别记录了LLM的**完整原始输出**（包括思考过程），为后续分析提供了宝贵数据。
    -   提供了`log_viewer.py`工具，方便按会话、按手牌进行日志查询。

## 🏗️ 项目结构

```
LLMPoker/
├── main.py              # 主程序入口
├── game_manager.py      # 游戏管理器，负责整体游戏流程控制
├── poker_engine.py      # 核心扑克游戏引擎，处理规则和状态
├── llm_client.py        # LLM客户端，负责与大语言模型API交互
├── logger.py            # 日志记录模块
├── log_viewer.py        # 日志查看工具
├── config.py            # 配置文件
└── requirements.txt     # 项目依赖
```

## 🛠️ 技术栈

-   **Python 3.x**
-   **openai>=1.3.0**: 用于与LLM API进行交互。
-   **poker**: 用于处理部分扑克牌的逻辑。
-   **rich**: 用于美化终端输出。
-   **python-dotenv**: 用于管理环境变量。

## 🎉 项目成果与结论

我们成功地将一个基础的扑克模拟器，迭代升级为一个具备**高级LLM交互能力**和**高度可观察性**的智能模拟平台。通过**精细化提示工程**和**严谨的bug修复**，我们不仅解决了程序层面的问题，更提升了AI玩家的决策质量和透明度。

这个项目现在是一个稳定、可靠且易于扩展的框架，可用于进一步研究LLM在复杂策略游戏中的行为。

---

**项目状态**: ✅ 功能完善，已通过多轮迭代测试  
**最后更新**: 反应了引入LLM思考过程和修复核心逻辑bug后的状态 